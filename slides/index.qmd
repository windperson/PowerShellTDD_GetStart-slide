---
title: PowerShell TDD èµ·æ­¥èµ°

author: è€é®‘ä¼¯
format:
    revealjs:
        width: 1200
        height: 900
        slide-tone: false
        theme: simple
        menu:
            side: right
        include-in-header: 
            text: |
                <style>
                .center-xy {
                margin: 0;
                position: absolute;
                top: 50%;
                left: 50%;
                -ms-transform: translateY(-50%), translateX(-50%);
                transform: translateY(-50%), translateX(-50%);
                }
                </style>
from: markdown+emoji
---

# Agenda

* å¦‚ä½•ç”¨ Visual Studio Code å»ºç½® PowerShell TDDé–‹ç™¼ç’°å¢ƒ
* PowerShell æ¸¬è©¦å·¥å…·æ¡†æ¶ Pesterä»‹ç´¹ã€ç‚ºæ—¢æœ‰ PowerShell scriptåŠ ä¸Šå¯åŸ·è¡Œçš„æ¸¬è©¦æ¡ˆä¾‹
* PowerShell + C# binary cmdlet~~ã€ASP.NET Core æ•´åˆ PowerShell Hosting Script çš„ TDD~~ç¯„ä¾‹

## VSCode as PowerShell TDD IDE

* å»ºè­°ä½¿ç”¨ [**VSCode**(Visual Studio Code)](http://code.visualstudio.com) å®‰è£å®˜æ–¹ [PowerShell Extension](http://github.com/PowerShell/vscode-powershell) + C# ç›¸é—œé–‹ç™¼æ“´å……å¥—ä»¶ ä½œç‚º PowerShell é–‹ç™¼ç’°å¢ƒ:
  * å®˜æ–¹å®‰è£è¨­å®šæ•™å­¸ï¼š<https://code.visualstudio.com/docs/languages/powershell>
  * æä¾› PowerShell çš„ Syntax Highlightingã€Outline Viewã€Go to Definitionã€IntelliSenseã€Code Lensã€Run & Debug Pester test code ç­‰åŠŸèƒ½ã€‚
  * å¯ debug PowerShell + C# binary cmdlet çš„æ··åˆå°ˆæ¡ˆã€‚

* ç‚ºäº†æœ‰ä¸€å€‹ä¹¾æ·¨ï¼†å¿«é€Ÿçš„TDDé–‹ç™¼ç’°å¢ƒï¼Œå»ºè­°ä½¿ç”¨[ Portable ç‰ˆæœ¬çš„ VSCode](http://code.visualstudio.com/docs/editor/portable)ï¼Œä»¥å…åŒæ™‚å®‰è£å¤ªå¤šæ“´å……å¥—ä»¶æ¶ˆè€—è³‡æºã€‚

## Example VSCode Environment

ç”±æ–¼ .NET SDK æœƒæ ¹æ“šä½œæ¥­ç³»çµ±ï¼†CPUæ¶æ§‹ä¸åŒè€Œæœ‰ä¸åŒçš„å®‰è£æ–¹å¼ï¼Œæä¾›ä»¥ä¸‹ç‰ˆæœ¬çš„ Portable VSCode + PowerShell Extension + C# ç›¸é—œé–‹ç™¼æ“´å……å¥—ä»¶ çš„ç¯„ä¾‹é–‹ç™¼ç’°å¢ƒï¼š

* [Windows 10 & 11 (x64)](https://github.com/windperson/vscode_win32x64_pwsh)
* [Windows 11 (ARM64)](https://github.com/windperson/vscode_win32x64_pwsh)
* [[TBD]macOS (ARM 64)]()
* [[TBD]Linux (x64)]()

## Example VSCode Environment - Windows 10 & 11 (x64)

é™¤äº†è¦æ‰‹å‹•é–‹å•ŸWindowsã€é–‹ç™¼è€…æ¨¡å¼ã€è¨­å®šä»¥åŠå°‡åŒæ†çš„ .NET SDK çš„åŸ·è¡Œæª”è·¯å¾‘åˆ°ç’°å¢ƒè®Šæ•¸ä¹‹å¤–ï¼Œå…¶ä»–çš„éƒ½æ˜¯ä½¿ç”¨ Portable ç‰ˆæœ¬çš„é–‹ç™¼ç’°å¢ƒï¼š

* Windows ç’°å¢ƒçš„ relative symbolic link éœ€è¦å•Ÿç”¨é–‹ç™¼è€…æ¨¡å¼æ‰èƒ½è®“ PowerShell ä»¥ä¸éœ€ç®¡ç†å“¡æ¬Šé™çš„æ–¹å¼è¨­å®šã€‚
![](./pics/win10_developer_mode.png)

## Example VSCode Environment - Windows 10 & 11 (x64)

.NET SDK çš„åŸ·è¡Œè·¯å¾‘å»ºè­°ä»¥ **DOTNET_ROOT** ç’°å¢ƒè®Šæ•¸è¨­å®šï¼Œä»¥ä¾¿æ–¼åˆ‡æ›ä¸åŒç‰ˆæœ¬çš„ dotnet æŒ‡ä»¤ï¼ˆä½¿ç”¨ç³»çµ±å®‰è£çš„ .NET SDK 8.0 ä¹ŸğŸ‘ŒğŸ†—ï¼‰ã€‚

![](./pics/)





## Pester - PowerShell Test Framework
